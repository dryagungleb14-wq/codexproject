// Prisma schema for the call quality MVP

generator client {
  provider = "prisma-client-py"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_DSN")
}

model Call {
  id           String    @id @default(cuid())
  filename     String
  durationSec  Int
  lang         String?
  consentFlag  Boolean   @default(false)
  createdAt    DateTime  @default(now())
  transcript   Transcript?
  metrics      Metrics?
}

model Transcript {
  id       String @id @default(cuid())
  callId   String @unique
  text     String
  segments Json
  call     Call   @relation(fields: [callId], references: [id])
}

model Metrics {
  id              String @id @default(cuid())
  callId          String @unique
  empathyScore    Float
  complianceScore Float
  structureScore  Float
  silencePct      Float
  overlapPct      Float
  speechRateWpm   Json
  interruptions   Json
  checklist       Json
  highlights      Json?
  call            Call   @relation(fields: [callId], references: [id])
}
